"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5925],{62728:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var s=n(11527),i=n(63883);const a={},o="Tip Gossip",r={id:"protocol/js-ceramic/networking/tip-gossip",title:"Tip Gossip",description:"When a stream is updated, the latest event (tip) is gossiped and propagated out to all the nodes in a network that are interested in that particular stream. Additionally, listening for all tips, allows a node to learn about streams it did not know about. This allows all interested nodes in the network to quickly get the latest update and state for a stream.",source:"@site/docs/protocol/js-ceramic/networking/tip-gossip.md",sourceDirName:"protocol/js-ceramic/networking",slug:"/protocol/js-ceramic/networking/tip-gossip",permalink:"/docs/protocol/js-ceramic/networking/tip-gossip",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"protocol",previous:{title:"Data Feed API",permalink:"/docs/protocol/js-ceramic/networking/data-feed-api"},next:{title:"Tip Queries",permalink:"/docs/protocol/js-ceramic/networking/tip-queries"}},l={},d=[{value:"Protocol",id:"protocol",level:2},{value:"Publishing Updates",id:"publishing-updates",level:3},{value:"Update Messages",id:"update-messages",level:3},{value:"Replicating Updates",id:"replicating-updates",level:3},{value:"Examples",id:"examples",level:2},{value:"TypeScript  Definitions",id:"typescript--definitions",level:3}];function p(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"tip-gossip",children:"Tip Gossip"}),"\n",(0,s.jsx)(t.p,{children:"When a stream is updated, the latest event (tip) is gossiped and propagated out to all the nodes in a network that are interested in that particular stream. Additionally, listening for all tips, allows a node to learn about streams it did not know about. This allows all interested nodes in the network to quickly get the latest update and state for a stream."}),"\n",(0,s.jsx)(t.h2,{id:"protocol",children:"Protocol"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"publishing-updates",children:"Publishing Updates"}),"\n",(0,s.jsxs)(t.p,{children:["When an event is created and appended to a stream, the node will publish an update message to the network. All messages are broadcast on the ",(0,s.jsx)(t.a,{href:"https://github.com/libp2p/specs/tree/master/pubsub",children:"libp2p pubsub"})," topic for the ",(0,s.jsx)(t.a,{href:"/docs/protocol/js-ceramic/networking/networks",children:"network"})," this node is configured for. Any other node listening on this network will receive the update and then can decide to take any further action or discard."]}),"\n",(0,s.jsx)(t.h3,{id:"update-messages",children:"Update Messages"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",children:"type UpdateMessage = {\n  typ: MsgType.UPDATE //0\n  stream: StreamID\n  tip: CID\n  model?: StreamID\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Where:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"typ"})})," - the message is an update message, enum ",(0,s.jsx)(t.code,{children:"0"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"stream"})})," - streamId of the stream which this update is for"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"tip"})})," - CID of the latest event (tip) of the stream, the update"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"model"})})," - streamId of the ComposeDB data model that the stream being updated belongs to (optional)"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"replicating-updates",children:"Replicating Updates"}),"\n",(0,s.jsxs)(t.p,{children:["Any nodes that have received an update message and are interested in that stream can now save the tip (update). Any node that has saved this update can now answer ",(0,s.jsx)(t.a,{href:"/docs/protocol/js-ceramic/networking/tip-queries",children:"tip queries"})," for this stream. As long as there is at least one node in the network with this information (tip) saved, the publishing node can go down without effecting the availability of the stream."]}),"\n",(0,s.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"typescript--definitions",children:"TypeScript  Definitions"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",children:"/**\n * Ceramic Pub/Sub message type.\n */\nenum MsgType {\n  UPDATE = 0,\n  QUERY = 1,\n  RESPONSE = 2,\n  KEEPALIVE = 3,\n}\n\ntype UpdateMessage = {\n  typ: MsgType.UPDATE\n  stream: StreamID\n  tip: CID  // the CID of the latest commit\n  model?: StreamID // optional\n}\n\n// All nodes will always ignore this message\ntype KeepaliveMessage = {\n  typ: MsgType.KEEPALIVE\n  ts: number // current time in milliseconds since epoch\n  ver: string // current ceramic version\n}\n"})})]})}function c(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},63883:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>o});var s=n(50959);const i={},a=s.createContext(i);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);